<!DOCTYPE html>
<!--
Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
-->
<html>
<head>
	<title>Using Fake selection &mdash; CKEditor Sample</title>
	<meta charset="utf-8">
	<script src="../../../ckeditor.js"></script>
	<link rel="stylesheet" href="../../../samples/sample.css">
	<link rel="stylesheet" href="fake.css">
	<script>

function onLoaded( evt ) {
	var editor = evt.editor;

	editor.on( 'instanceReady', function() {
		var divs = editor.editable().getElementsByTag( 'div' );

		for ( var i = 0; i < divs.count(); ++i )
			initFake( editor, divs.getItem( i ) );
	} );
}

function initFake( editor, el ) {
	var focused = false;

	el.setAttribute( 'contenteditable', 'false' );

	editor.editable().on( 'mouseup', function( evt ) {
		if ( el.equals( evt.data.getTarget() ) )
			focusFake( editor, el );
		else
			blurFake( editor, el );
	} );

	// Dear FF, you suck!
	// Prevent dragging widgets.
	editor.editable().on( 'dragstart', function( evt ) {
		evt.data.preventDefault();
	} );

	editor.on( 'blur', blurFake );

	function focusFake() {
		if ( focused ) {
			// Move true selection back to hidden el, when clicked fake object 2nd time.
			editor.getSelection().update();
			return;
		}

		focused = true;
		var sel = new CKEDITOR.dom.fakeSelection( editor.editable(), el );
		editor.lockHardSelection( sel );
		el.addClass( 'focused' );
	}

	function blurFake() {
		if ( !focused )
			return;

		focused = false;
		el.removeClass( 'focused' );
		var sel = editor.getSelection();
		if ( sel instanceof CKEDITOR.dom.fakeSelection )
			sel.destroy();
		else
			console.error( sel, 'should be an instance of fakeSelection' );
	}
}

	</script>
</head>
<body>
	<h1 class="samples">
		<a href="../../../samples/index.html">CKEditor Samples</a> &raquo; Using Fake selection
	</h1>
	<div>
		<label for="editor1">
			Editor 1:
		</label>
		<textarea cols="80" id="editor1" name="editor1" rows="10">
			&lt;h1>Apollo 11&lt;/h1>

			&lt;div class="fake" style="float:left">FAKE&lt;/div>

			&lt;p>&lt;strong>Apollo 11&lt;/strong> was the spaceflight that landed the first humans, Americans &lt;a href="http://en.wikipedia.org/wiki/Neil_Armstrong" title="Neil Armstrong">Neil Armstrong&lt;/a> and &lt;a href="http://en.wikipedia.org/wiki/Buzz_Aldrin" title="Buzz Aldrin">Buzz Aldrin&lt;/a>, on the Moon on July 20, 1969, at 20:18 UTC. Armstrong became the first to step onto the lunar surface 6 hours later on July 21 at 02:56 UTC.&lt;/p>

			&lt;div class="fake" style="float:right">FAKE&lt;/div>

			&lt;p>Armstrong spent about &lt;s>three and a half&lt;/s> two and a half hours outside the spacecraft, Aldrin slightly less; and together they collected 47.5 pounds (21.5&nbsp;kg) of lunar material for return to Earth. A third member of the mission, &lt;a href="http://en.wikipedia.org/wiki/Michael_Collins_(astronaut)" title="Michael Collins (astronaut)">Michael Collins&lt;/a>, piloted the &lt;a href="http://en.wikipedia.org/wiki/Apollo_Command/Service_Module" title="Apollo Command/Service Module">command&lt;/a> spacecraft alone in lunar orbit until Armstrong and Aldrin returned to it for the trip back to Earth.&lt;/p>

			&lt;h2>Broadcasting and &lt;em>quotes&lt;/em>&lt;/h2>

			&lt;p>Broadcast on live TV to a world-wide audience, Armstrong stepped onto the lunar surface and described the event as:&lt;/p>

			&lt;p>One small step for [a] man, one giant leap for mankind.&lt;/p>

			&lt;p>Apollo 11 effectively ended the &lt;a href="http://en.wikipedia.org/wiki/Space_Race" title="Space Race">Space Race&lt;/a> and fulfilled a national goal proposed in 1961 by the late U.S. President &lt;a href="http://en.wikipedia.org/wiki/John_F._Kennedy" title="John F. Kennedy">John F. Kennedy&lt;/a> in a speech before the United States Congress:&lt;/p>

			&lt;p>[...] before this decade is out, of landing a man on the Moon and returning him safely to the Earth.&lt;/p>
		</textarea>
		<script>

			CKEDITOR.replace( 'editor1', {
				contentsCss: [ '../../../contents.css', 'fake.css' ],
				extraPlugins: 'fakeselection',
				on: {
					loaded: onLoaded
				}
			} );

		</script>
	</div>
	<br>
	<div>
		<label for="editor2">
			Editor 2:
		</label>
		<div id="editor2">
			<h1>Apollo 11</h1>

			<div class="fake" style="float:left">FAKE</div>

			<p><strong>Apollo 11</strong> was the spaceflight that landed the first humans, Americans <a href="http://en.wikipedia.org/wiki/Neil_Armstrong" title="Neil Armstrong">Neil Armstrong</a> and <a href="http://en.wikipedia.org/wiki/Buzz_Aldrin" title="Buzz Aldrin">Buzz Aldrin</a>, on the Moon on July 20, 1969, at 20:18 UTC. Armstrong became the first to step onto the lunar surface 6 hours later on July 21 at 02:56 UTC.</p>

			<div class="fake" style="float:right">FAKE</div>

			<p>Armstrong spent about <s>three and a half</s> two and a half hours outside the spacecraft, Aldrin slightly less; and together they collected 47.5 pounds (21.5&nbsp;kg) of lunar material for return to Earth. A third member of the mission, <a href="http://en.wikipedia.org/wiki/Michael_Collins_(astronaut)" title="Michael Collins (astronaut)">Michael Collins</a>, piloted the <a href="http://en.wikipedia.org/wiki/Apollo_Command/Service_Module" title="Apollo Command/Service Module">command</a> spacecraft alone in lunar orbit until Armstrong and Aldrin returned to it for the trip back to Earth.</p>

			<h2>Broadcasting and <em>quotes</em></h2>

			<p>Broadcast on live TV to a world-wide audience, Armstrong stepped onto the lunar surface and described the event as:</p>

			<p>One small step for [a] man, one giant leap for mankind.</p>

			<p>Apollo 11 effectively ended the <a href="http://en.wikipedia.org/wiki/Space_Race" title="Space Race">Space Race</a> and fulfilled a national goal proposed in 1961 by the late U.S. President <a href="http://en.wikipedia.org/wiki/John_F._Kennedy" title="John F. Kennedy">John F. Kennedy</a> in a speech before the United States Congress:</p>

			<p>[...] before this decade is out, of landing a man on the Moon and returning him safely to the Earth.</p>
		</div>
		<script>

			CKEDITOR.document.getById( 'editor2' ).setAttribute( 'contenteditable', true );
			var editor = CKEDITOR.inline( 'editor2', {
				extraPlugins: 'fakeselection',
				on: {
					loaded: onLoaded
				}
			} );

		</script>
	</div>
	<div id="footer">
		<hr>
		<p>
			CKEditor - The text editor for the Internet - <a class="samples" href="http://ckeditor.com/">http://ckeditor.com</a>
		</p>
		<p id="copy">
			Copyright &copy; 2003-2013, <a class="samples" href="http://cksource.com/">CKSource</a> - Frederico
			Knabben. All rights reserved.
		</p>
	</div>
</body>
</html>
